val data: List[Int] = List(968, 565, 322, 94, 889, 387, 264, 268, 155, 21, 417, 336, 730, 532, 158, 202, 507, 976, 611, 890, 671, 342, 917, 165, 759, 182, 460, 224, 147, 757, 848, 812, 622, 134, 703, 388, 715, 842, 515, 380, 45, 569, 815, 133, 750, 955, 953, 910, 415, 646, 623, 164, 612, 703, 68, 376, 279, 869, 573, 916, 681, 418, 491, 775, 629, 94, 515, 508, 964, 92, 335, 413, 50, 202, 137, 762, 175, 982, 629, 941, 288, 255, 387, 426, 488, 354, 390, 875, 29, 240, 510, 11, 363, 57, 597, 648, 955, 724, 567, 876, 144, 893, 522, 455, 359, 983, 535, 447, 341, 985, 194, 396, 887, 479, 366, 745, 775, 605, 958, 713, 197, 720, 606, 576, 14, 171, 368, 116, 588, 870, 446, 64, 774, 358, 928, 484, 901, 670, 318, 401, 206, 543, 378, 453, 247, 521, 392, 963, 264, 31, 557, 659, 354, 789, 593, 184, 544, 785, 45, 664, 585, 677, 0, 854, 310, 591, 93, 825, 942, 257, 747, 689, 603, 893, 578, 630, 582, 460, 765, 372, 629, 733, 959, 272, 670, 146, 22, 418, 830, 518, 485, 477, 605, 559, 74, 533, 340, 562, 141, 858, 924, 756, 78, 340, 731, 616, 64, 314, 434, 848, 615, 644, 227, 836, 419, 241, 379, 127, 932, 599, 831, 900, 983, 583, 678, 420, 483, 448, 12, 242, 910, 977, 553, 236, 861, 716, 904, 585, 428, 525, 84, 560, 502, 3, 167, 248, 453, 968, 498, 358, 765, 780, 968, 942, 350, 251, 244, 131, 249, 809, 722, 981, 337, 794, 146, 109, 477, 121, 552, 150, 280, 941, 197, 895, 282, 656, 614, 668, 840, 393, 789, 668, 540, 983, 738, 949, 236, 635, 423, 253, 83, 736, 43, 133, 109, 606, 214, 664, 936, 669, 462, 589, 205, 163, 732, 920, 203, 464, 350, 833, 887, 90, 976, 251, 269, 692, 594, 591, 709, 668, 548, 9, 114, 565, 917, 948, 539, 92, 311, 854, 919, 397, 280, 795, 958, 245, 89, 68, 270, 877, 583, 28, 946, 589, 209, 81, 628, 588, 60, 219, 74, 209, 941, 511, 873, 401, 83, 688, 704, 280, 116, 333, 74, 629, 254, 217, 915, 454, 519, 997, 845, 100, 6, 844, 171, 963, 788, 566, 874, 542, 110, 433, 955, 442, 941, 228, 517, 915, 769, 15, 840, 749, 785, 744, 560, 591, 234, 59, 775, 296, 773, 673, 507, 533, 111, 171, 538, 662, 116, 462, 12, 852, 782, 899, 613, 513, 186, 716, 322, 396, 617, 621, 973, 89, 527, 248, 839, 274, 919, 718, 509, 786, 4, 732, 158, 436, 743, 468, 97, 596, 926, 36, 221, 730, 55, 413, 528, 435, 139, 588, 408, 58, 877, 104, 811, 611, 460, 320, 718, 550, 350, 471, 563, 967, 929, 70, 380, 862, 911, 258, 495, 465, 739, 478, 516, 47, 975, 227, 221, 227, 864, 737, 719, 590, 834, 99, 879, 302, 693, 777, 650, 534, 664, 431, 300, 684, 217, 698, 37, 832, 848, 885, 734, 346, 585, 554, 670, 319, 17, 608, 330, 312, 56, 814, 256, 951, 498, 662, 907, 35, 667, 68, 271, 200, 85, 726, 712, 600, 159, 834, 141, 761, 324, 520, 181, 522, 969, 530, 382, 945, 717, 658, 933, 162, 322, 946, 562, 431, 536, 893, 470, 27, 750, 810, 199, 248, 175, 950, 359, 470, 561, 259, 947, 137, 200, 414, 840, 569, 80, 320, 696, 698, 535, 383, 123, 194, 707, 713, 448, 948, 456, 821, 872, 545, 75, 571, 73, 209, 329, 849, 578, 659, 899, 909, 316, 447, 241, 407, 851, 685, 267, 907, 673, 464, 986, 9, 842, 915, 469, 370, 979, 600, 44, 533, 286, 865, 630, 913, 851, 822, 520, 270, 926, 915, 723, 727, 323, 352, 174, 679, 266, 277, 744, 1000, 303, 233, 4, 550, 942, 316, 114, 324, 699, 468, 46, 553, 144, 480, 602, 669, 351, 635, 302, 349, 887, 385, 314, 762, 108, 114, 998, 753, 55, 793, 566, 945, 682, 334, 574, 623, 520, 522, 672, 853, 121, 668, 105, 470, 769, 562, 965, 487, 48, 881, 53, 954, 816, 894, 580, 515, 987, 276, 544, 756, 368, 799, 837, 885, 424, 928, 591, 520, 493, 683, 221, 82, 454, 648, 944, 824, 265, 663, 319, 613, 116, 584, 471, 376, 142, 454, 216, 543, 804, 585, 284, 920, 49, 323, 179, 176, 336, 746, 993, 522, 418, 122, 670, 208, 582, 749, 798, 228, 661, 677, 990, 926, 724, 929, 324, 277, 823, 46, 103, 299, 543, 171, 393, 337, 402, 429, 450, 44, 332, 76, 127, 465, 571, 729, 787, 970, 299, 998, 104, 754, 285, 46, 357, 223, 573, 871, 447, 877, 34, 632, 964, 240, 180, 974, 53, 967, 198, 54, 707, 496, 606, 10, 376, 562, 270, 606, 474, 375, 792, 163, 434, 561, 417, 222, 456, 763, 701, 2, 985, 396, 130, 430, 264, 169, 793, 415, 18, 886, 942, 90, 420, 482, 45, 923, 24, 467, 454)

def msort[T](xs: List[T])(lt: (T, T) => Boolean): List[T] = {
  val n = xs.length / 2
  if (n == 0) xs
  else {
    def merge(xs: List[T], ys: List[T]): List[T] = (xs, ys) match {
      case (Nil, ys1) => ys1
      case (xs1, Nil) => xs1
      case (x :: xs1, y :: ys1) =>
        if (lt(x, y)) x :: merge(xs1, ys)
        else y :: merge(xs, ys1)
    }

    val (fst, snd) = xs splitAt n
    merge(msort(fst)(lt), msort(snd)(lt))
  }
}

val fruits = List("apple", "pineapple", "orange", "banana")

msort(data)((x, y) => x.compareTo(y) < 0)
msort(fruits)((x, y) => x.compareTo(y) < 0)